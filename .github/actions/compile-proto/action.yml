name: Compile Measurements Proto Contracts
description: Compile protobuf contracts for measurements subsystem

inputs:
  path:
    description: Path to the directory containing the proto files
    required: true
    default: ./source/bronze/src/bronze/infrastructure/contracts
runs:
  using: composite
  steps:
    - name: Install Protoc
      uses: arduino/setup-protoc@v3

    - name: Compile descriptor files
      shell: bash
      run: |
        pushd '${{ inputs.path }}'
        mkdir ./assets
        protoc --include_imports --descriptor_set_out=assets/persist_submitted_transaction.binpb PersistSubmittedTransaction.proto
        protoc --include_imports --descriptor_set_out=assets/submitted_transaction_persisted.binpb SubmittedTransactionPersisted.proto
        popd
